{%load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>PyDServe : Administration</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    
    <link rel="stylesheet" type="text/css" href="{%static ''%}bootstrap/main.css">
    <link rel="stylesheet" type="text/css" href="{%static ''%}bootstrap/css/bootstrap.min.css">

    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css" href="{%static ''%}font-awesome-4.7.0/css/font-awesome.min.css">
  </head>
  <style type="text/css">
    @font-face{
      font-family: 'sans';
      src:url('{%static ''%}font/SourceSansPro-Regular.ttf');
    }
    @font-face{
      font-family: 'fira';
      src:url('{%static ''%}font/FiraCode-Regular.ttf');
    }
    pre{
      font-family: fira;
      border:1px solid;
      padding:5px;
      max-height: 500px;
    }
    body{
      font-family: 'sans';
      background-color: #f2f2f2;
      font-size: 14px;
    }
    .form-control, .btn{
      border-radius: unset !important;
    }
    .title{
      text-transform: uppercase;
      font-weight: bold
    }

  </style>
  <body class="app sidebar-mini rtl">
    <!-- Navbar-->
    <header class="app-header" style="background: linear-gradient(to right, #ff66d9 10%, #00e6e6 100%);"><a style="background-color:unset;font-family: unset;font-size: 20px " class="app-header__logo" href="{%url 'dashboard'%}">PyDServe Admin</a>
      <!-- Sidebar toggle button-->
      <a class="app-sidebar__toggle" href="#" data-toggle="sidebar" aria-label="Hide Sidebar"></a>

      <!-- Navbar Right Menu-->
      <ul class="app-nav">
        <li class="app-search">
          <input class="app-search__input" type="search" placeholder="Search">
          <button class="app-search__button"><i class="fa fa-search"></i></button>
        </li>
        <!-- User Menu-->
        <li class="dropdown"><a class="app-nav__item" href="#" data-toggle="dropdown" aria-label="Open Profile Menu" style="text-decoration: none;text-transform: uppercase;"><i class="fa fa-user fa-lg"></i></a>
          <ul class="dropdown-menu settings-menu dropdown-menu-right">
            <li><a class="dropdown-item" href="http://localhost/kiara2/index.php/admin/setting"><i class="fa fa-cog fa-lg"></i> Settings</a></li>
            <li><a class="dropdown-item" href="http://localhost/kiara2/index.php/admin/user_settings"><i class="fa fa-user fa-lg"></i> Profile</a></li>
            <li><a class="dropdown-item" href="{%url 'logout'%}"><i class="fa fa-sign-out fa-lg"></i> Logout</a></li>
          </ul>
        </li>
      </ul>
    </header>
    <!-- Sidebar menu-->
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    <aside class="app-sidebar">
      <div class="app-sidebar__user">
        <i class="fa fa-user" style="font-size: 30px"></i>
        <div class="ml-2">
          <p class="app-sidebar__user-name" style="font-size: 14px">{{userdata.username}} (Logged In)</p>
          <p class="app-sidebar__user-designation" style="font-size: 13px">{{userdata.first_name}} {{userdata.last_name}}</p>
        </div>
      </div>
      <ul class="app-menu">
        <li>
          <a class="app-menu__item" href="{%url 'dashboard'%}">
            <i class="app-menu__icon fa fa-dashboard"></i>
            <span class="app-menu__label">Dashboard</span>
          </a>
        </li>
        
        <li class="treeview"><a class="app-menu__item" href="#" data-toggle="treeview"><i class="app-menu__icon fa fa-cogs"></i><span class="app-menu__label">System</span><i class="treeview-indicator fa fa-angle-right"></i></a>
          <ul class="treeview-menu">
            <li><a class="treeview-item" href="{% url 'syslog'%}"><i class="icon fa fa-circle-o"></i> SysLog</a></li>
            <li><a class="treeview-item" href="http://localhost/kiara2/index.php/admin/setting"><i class="icon fa fa-circle-o"></i> Settings</a></li>
            <li><a class="treeview-item" href="{%url 'sysinfo'%}"><i class="icon fa fa-circle-o"></i> About System</a></li>
          </ul>
        </li>
      </ul>
    </aside>


  <main class="app-content">
      {%block main%}
      {%endblock%}
  </main>
   <footer></footer>

 <!-- Essential javascripts for applicat ion to work-->
 <script src="{%static ''%}jquery/jquery.min.js"></script>
<script src="{%static ''%}js/popper.min.js"></script>
<script src="{%static ''%}js/bootstrap-material-design.min.js"></script>
<script>$(document).ready(function() { $('body').bootstrapMaterialDesign(); });</script>
    <script src="{%static ''%}bootstrap/main.js"></script>
    <!-- The javascript plugin to display page loading on top-->
    <!-- <script src="js/plugins/pace.min.js"></script> -->
    <!-- Page specific javascripts-->
    <!-- <script type="text/javascript" src="js/plugins/chart.js"></script> -->
<script type="text/javascript">
  $('.progressing').hide()
  $(function (){
      setInterval(function(){
          $.getJSON("{%url 'sysload'%}",function(data){
            $(".cpu-progress").each(function() {
                var value = data.cpu_load;
                $('.cpu-load').html(data.cpu_load)
                var left = $(this).find('.progress-left .progress-bar');
                var right = $(this).find('.progress-right .progress-bar');
                left.css('transform', 'rotate(' + percentageToDegrees(0) + 'deg)')
                if (value > 0) {
                  if (value <= 40) {
                    $('.progress-cpu').css("border-color","#00cc00")
                    right.css('transform', 'rotate(' + percentageToDegrees(value) + 'deg)')
                  } else if(value > 40 && value < 80){
                    $('.progress-cpu').css("border-color","#ff5722")
                    right.css('transform', 'rotate(180deg)')
                    left.css('transform', 'rotate(' + percentageToDegrees(value - 50) + 'deg)')
                  }else if (value >= 80){
                    $('.progress-cpu').css("border-color","#f44336")
                    right.css('transform', 'rotate(180deg)')
                    left.css('transform', 'rotate(' + percentageToDegrees(value - 50) + 'deg)')
                  }
                }

              })
            $(".mem-progress").each(function() {
                var value = data.memory_load;
                $('.mem-load').html(data.memory_load)
                var left = $(this).find('.progress-left .progress-bar');
                var right = $(this).find('.progress-right .progress-bar');
                left.css('transform', 'rotate(' + percentageToDegrees(0) + 'deg)')
                if (value > 0) {
                  if (value <= 40) {
                    $('.progress-mem').css("border-color","#00cc00")
                    right.css('transform', 'rotate(' + percentageToDegrees(value) + 'deg)')
                  } else if(value > 40 && value < 80){
                    $('.progress-mem').css("border-color","#ff5722")
                    right.css('transform', 'rotate(180deg)')
                    left.css('transform', 'rotate(' + percentageToDegrees(value - 50) + 'deg)')
                  }else if (value >= 80){
                    $('.progress-mem').css("border-color","#f44336")
                    right.css('transform', 'rotate(180deg)')
                    left.css('transform', 'rotate(' + percentageToDegrees(value - 50) + 'deg)')
                  }
                }

              })
            $(".disk-progress").each(function() {
                var diskvalue = data.disk_load;
                $('.disk-load').html(data.disk_load)
                var left = $(this).find('.progress-left .progress-bar');
                var right = $(this).find('.progress-right .progress-bar');
                left.css('transform', 'rotate(' + percentageToDegrees(0) + 'deg)')
                if (diskvalue > 0) {
                  if (diskvalue <= 50) {
                    $('.progress-disk').css("border-color","#00cc00")
                    right.css('transform', 'rotate(' + percentageToDegrees(diskvalue) + 'deg)')
                  } else if(diskvalue > 50 && value < 80){
                    $('.progress-disk').css("border-color","#ff5722")
                    right.css('transform', 'rotate(180deg)')
                    left.css('transform', 'rotate(' + percentageToDegrees(diskvalue - 50) + 'deg)')
                  }else if (diskvalue >= 80){
                    $('.progress-disk').css("border-color","#f44336")
                    right.css('transform', 'rotate(180deg)')
                    left.css('transform', 'rotate(' + percentageToDegrees(diskvalue - 50) + 'deg)')
                  }
                }

              })
          })
      },3000)
  })


  function percentageToDegrees(percentage) {

    return percentage / 100 * 360

  }

$(document).ready(function(){
  $('.progressing').show()
})

</script>
</html>